# IP-PORT-TOOL v2.0

一个的 CSV/TXT 文件处理工具，专注于 IP 和端口数据的提取、格式化、去重和导出。

![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Version](https://img.shields.io/badge/Version-2.0-orange.svg)

> 💡 本项目在 AI 指导下完成，作为熟悉学习 GitHub 的实践项目。功能较为简单，应用单一，或许未来可以有更好的拓展。

## ✨ 核心特点

- 🧠 **智能解析**: 自动识别文本文件分隔符（支持 `#` `|` `:` `-` `,` 等多种分隔符）
- 🚀 **快速模式**: 拖拽文件即可处理，零学习成本
- 🎨 **自定义模式**: 灵活选择列和输出格式，满足复杂需求
- 🔍 **智能识别**: 自动检测 IP 地址列、端口列，支持带协议前缀的 URL
- 🔄 **去重排序**: 支持数据去重和按指定列排序
- 📊 **实时预览**: 处理前显示数据预览和格式效果
- 🛡️ **纯本地处理**: 数据不上传，保护隐私安全
- ⚡ **高性能**: 基于 pandas，轻松处理大文件

## 🎯 应用场景

本工具特别适合以下场景：

1. **配合测速工具使用**
   - 搭配 [cfiptest](https://github.com/jackrun123/cfiptest) 等测速项目
   - 批量处理测速结果数据
   
2. **订阅管理**
   - 维护 [cm的订阅器api](https://github.com/cmliu/WorkerVless2sub) 
   - 格式化节点信息
   
3. **数据处理**
   - IP 地址批量提取
   - 端口信息整理
   - 多列数据组合导出

## 📦 安装使用

### 方式一：下载 EXE（推荐新手）

1. 前往 [Releases](https://github.com/231128ikun/ip-port-tool/releases) 页面
2. 下载最新版本的 `IP-PORT-TOOL.exe`
3. 双击运行或拖拽文件使用

### 方式二：运行源代码

```bash
# 克隆项目
git clone https://github.com/231128ikun/ip-port-tool.git
cd ip-port-tool

# 安装依赖
pip install pandas

# 运行程序
python ip_tool.py
```

### 方式三：自行打包

```bash
# 安装 PyInstaller
python -m pip install pyinstaller

# 打包为单文件 EXE
python -m PyInstaller --onefile --console --name "IP-PORT-tool" "ip-port-tool.py"
```

## 🎮 使用指南

### 快速模式（拖拽即用）

**适用场景**: 快速提取 IP:端口格式数据

#### CSV/Excel 文件
1. 将文件拖拽到 `IP-PORT-TOOL.exe` 上
2. 程序自动识别 IP 和端口列
3. 自动输出 `results.txt`（格式：`IP:端口`）

#### TXT 文本文件
1. 拖拽 TXT 文件到程序
2. 选择提取模式：
   - 模式 1：提取 `IP:端口` 格式
   - 模式 2：仅提取 IP 地址
3. 自动输出结果文件

**特点**:
- ✅ 自动去重
- ✅ 自动排序
- ✅ 无端口时自动添加默认端口 443
- ✅ 支持识别 `IP:端口` 格式并拆分

### 自定义模式（高级功能）

**适用场景**: 需要自定义输出格式，处理复杂表格数据

#### 操作步骤

1. **启动程序**
   ```
   双击 IP-PORT-TOOL.exe → 选择模式 2
   ```

2. **选择文件**
   ```
   输入文件路径或拖拽文件到窗口
   ```

3. **查看列信息**
   ```
   程序显示所有列及示例数据
   列1(IP地址) → 示例: 192.168.1.1 | 10.0.0.1
   列2(端口) → 示例: 443 | 8080
   列3(文本) → 示例: Beijing | Shanghai
   ```

4. **选择要输出的列**
   ```
   输入: 1 2 3
   (选择第1、2、3列)
   ```

5. **选择输出格式**
   ```
   1. [1] [2]                    → 第一列 第二列
   2. [1]:[2]                   → 第一列:第二列
   3. [1]:[2]#[3]               → 第一列:第二列#第三列
   4. [1]:[2]#[3]|[4]           → 第一列:第二列#第三列|第四列
   5. [1]:[2]#[3]|[4]|[5]       → 第一列:第二列#第三列|第四列|第五列
   6. 自定义格式                 → 自由组合
   ```

6. **查看预览**
   ```
   程序显示前 3 行数据的格式效果
   ```

7. **设置处理选项**
   - 是否去重（默认是）
   - 选择排序方式（可按任意列排序）
   - 设置输出文件名

8. **完成导出**
   ```
   自动保存为 .txt 文件
   ```

### 智能文本解析

程序支持自动识别以下分隔符的文本文件：

| 分隔符 | 示例 |
|--------|------|
| `#` | `192.168.1.1#443#Beijing` |
| `\|` | `192.168.1.1\|443\|Beijing` |
| `:` | `192.168.1.1:443:Beijing` |
| `-` | `192.168.1.1-443-Beijing` |
| `,` | `192.168.1.1,443,Beijing` |
| 制表符 | `192.168.1.1	443	Beijing` |
| 空格 | `192.168.1.1 443 Beijing` |

**智能识别规则**:
- 自动检测最合适的分隔符
- 自动识别 `IP:端口` 格式并拆分为两列
- 自动判断列类型（IP地址、端口、文本）

## 📝 输出格式详解

### 常用格式示例

| 格式模板 | 输出示例 | 适用场景 |
|---------|---------|---------|
| `[1]:[2]` | `192.168.1.1:443` | 基础节点格式 |
| `[1]:[2]#[3]` | `192.168.1.1:443#Beijing` | 带地区标识 |
| `[1]:[2]#[3]\|[4]` | `192.168.1.1:443#Beijing\|20ms` | 带延迟信息 |
| `[1]:[2]#[3]\|[4]\|[5]` | `192.168.1.1:443#Beijing\|20ms\|1000kB/s` | 完整测速数据 |
| `[1] [2]` | `192.168.1.1 443` | 空格分隔 |

### 自定义格式

使用 `[数字]` 表示对应列的位置，可以自由组合任意符号：

```
示例 1: https://[1]:[2]
输出: https://192.168.1.1:443

示例 2: [3]-[1]-[2]
输出: Beijing-192.168.1.1-443

示例 3: [1]:[2] // [3] @ [4]ms
输出: 192.168.1.1:443 // Beijing @ 20ms
```

## 🗂️ 支持的文件格式

### 输入格式

- ✅ **CSV 文件** (.csv)
  - 标准 CSV 格式
  - 带表头的表格数据
  
- ✅ **文本文件** (.txt)
  - 纯 IP 列表
  - `IP:端口` 格式
  - 多种分隔符格式
  - 自由格式文本（智能解析）

- ✅ **Excel 文件** (.xlsx, .xls)
  - 标准 Excel 表格
  - 多列数据

- ✅ **表格格式数据**
  - 管道符分隔 (|)
  - 制表符分隔

### 智能列识别

程序通过关键字自动识别列类型：

- **IP 列**: 包含 `ip`、`地址`、`host` 关键字
- **端口列**: 包含 `port`、`端口` 关键字
- **自动检测**: 通过正则表达式识别 IP 格式

### 性能优化

- 使用 pandas 处理大数据
- 内存优化的去重算法
- 流式处理文本文件

## 💻 系统要求

### EXE 版本
- **操作系统**: Windows 7/8/10/11 (64位)
- **运行环境**: 无需安装 Python
- **内存**: 至少 100MB 可用空间
- **磁盘**: 5MB（程序体积）

### 源码版本
- **Python 版本**: 3.7 或更高
- **依赖库**: pandas
- **操作系统**: Windows / Linux / macOS

## 📚 常见问题

### Q1: 文件识别失败怎么办？
**A**: 
- 检查文件编码是否为 UTF-8
- 确认文件格式是否符合要求
- 尝试使用自定义模式手动选择

### Q2: 如何处理带协议的 URL？
**A**: 程序会自动清理 `http://` 和 `https://` 前缀，只保留 IP 或域名部分。

### Q3: 默认端口是多少？
**A**: 快速模式默认端口为 443，可在非拖拽模式下自定义。

### Q4: 支持 IPv6 吗？
**A**: 当前版本主要针对 IPv4，IPv6 支持将在后续版本添加。

### Q5: 如何批量处理多个文件？
**A**: 目前需要逐个处理，批量处理功能计划在后续版本添加。

## 🛠️ 开发信息

### 技术栈
- **编程语言**: Python 3.x
- **核心依赖**: pandas
- **打包工具**: PyInstaller
- **编码规范**: PEP 8

### 项目结构
```
ip-port-tool/
├── ip_tool.py          # 主程序源码
├── README.md           # 项目说明
├── LICENSE             # MIT 许可证
└── requirements.txt    # 依赖列表（如有）
```

## 📄 许可证

本项目采用 [MIT 许可证](LICENSE) - 查看 LICENSE 文件了解详情

## 🙏 致谢

- 感谢 AI 辅助开发
- 感谢开源社区的支持
---

⭐ 如果这个项目对你有帮助，欢迎 Star 支持！


